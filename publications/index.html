---
layout: default
title: Publications
---

{% assign sorted_pubs = site.publications | sort: 'date' | reverse %}
{% include populate_filters.html %}

<div class="publications-page">
  <h1>Publications</h1>

  <!-- Mobile Controls (Filter Button + Search) -->
  <div class="mobile-controls">
    <button class="mobile-filter-toggle btn">Filters</button>
    <input type="text" class="pub-search mobile-search" placeholder="Search" />
  </div>

  <!-- Filter Overlay (for mobile) -->
  <div class="filter-overlay">
    <div class="filter-panel">
      <header>
        <button class="close-filters">×</button>
      </header>

      <div class="filter-section">
        <!-- Year Published -->
        <h3>Year Published</h3>
        <select id="mobile-yearSelect">
          <option value="">All</option>
          {% for y in years %}
            <option value="{{ y }}">{{ y }}</option>
          {% endfor %}
        </select>

        <!-- Health Topic -->
        <h3>Health Topic</h3>
        <select id="mobile-healthTopicSelect">
          <option value="">All</option>
          {% for topic in healthTopics %}
            <option value="{{ topic }}">{{ topic }}</option>
          {% endfor %}
        </select>

        <!-- Venue -->
        <h3>Publication Venue</h3>
        <select id="mobile-venueSelect">
          <option value="">All</option>
          {% for venue in venues %}
            {% include venue_name.html venue=venue %}
            <option value="{{ venue }}">{{ venue_transformed }}</option>
          {% endfor %}
        </select>

        <!-- Author -->
        <h3>Graduate Student Author</h3>
        <select id="mobile-authorSelect">
          <option value="">Anyone</option>
          {% for author in all_author_ids %}
            {% assign found_member = site.data.members | where:"id", author | first %}
            {% if found_member %}
              {% if found_member.degree == 'PhD' or found_member.degree == "MSc" or found_member.degree == 'MScAC' %}
                <option value="{{ found_member.id }}">{{ found_member.name }}</option>
              {% endif %}
            {% endif %}
          {% endfor %}
        </select>

        <hr />

        <!-- Checkbox Filters -->
        <!-- Theme -->
        <div class="filter-group theme">
          <h3>Theme</h3>
          {% for theme in themes %}
            <label>
              <input type="checkbox" class="mobile-theme-checkbox" value="{{ theme }}" /> {{ theme }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Skills -->
        <div class="filter-group skills">
          <h3>Skills</h3>
          {% for skill in skills %}
            <label>
              <input type="checkbox" class="mobile-skill-checkbox" value="{{ skill }}" /> {{ skill }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Relevant Device -->
        <div class="filter-group device">
          <h3>Relevant Devices</h3>
          {% for dev in devices %}
            <label>
              <input type="checkbox" class="mobile-device-checkbox" value="{{ dev }}" /> {{ dev }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Awards -->
        <div class="filter-group awards">
          <h3>Awards</h3>
          {% for award in awards %}
            <label>
              <input type="checkbox" class="mobile-award-checkbox" value="{{ award }}" /> {{ award }}
            </label><br />
          {% endfor %}
        </div>

        <button class="apply-filters">Apply</button>
      </div>
    </div>
  </div>

  <div class="publication-content-row">
    <!-- Left Column: Filter Panel (desktop version) -->
    <div class="filter-section">
      <!-- Search bar -->
      <input type="text" class="pub-search desktop-search" placeholder="Search" />

      <!-- Year Published -->
      <h3 for="yearSelect">Year Published</h3>
      <select id="yearSelect">
        <option value="">All</option>
        {% for y in years %}
          <option value="{{ y }}">{{ y }}</option>
        {% endfor %}
      </select>

      <!-- Health Topic -->
      <h3 for="healthTopicSelect">Health Topic</h3>
      <select id="healthTopicSelect">
        <option value="">All</option>
        {% for topic in healthTopics %}
          <option value="{{ topic }}">{{ topic }}</option>
        {% endfor %}
      </select>

      <!-- Venue -->
      <h3 for="venueSelect">Publication Venue</h3>
      <select id="venueSelect">
        <option value="">All</option>
        {% for venue in venues %}
          {% include venue_name.html venue=venue %}
          <option value="{{ venue }}">{{ venue_transformed }}</option>
        {% endfor %}
      </select>

      <!-- Author -->
      <h3 for="authorSelect">Graduate Student Author</h3>
      <select id="authorSelect">
        <option value="">Anyone</option>
        {% for author in all_author_ids %}
          {% assign found_member = site.data.members | where:"id", author | first %}
          {% if found_member %}
            {% if found_member.degree == 'PhD' or found_member.degree == "MSc" or found_member.degree == 'MScAC' %}
              <option value="{{ found_member.id }}">{{ found_member.name }}</option>
            {% endif %}
          {% endif %}
        {% endfor %}
      </select>

      <hr />

      <!-- Checkbox Filters -->
      <!-- Theme (Publication Category) -->
      <div class="filter-group theme">
        <h3>Theme</h3>
        {% for theme in themes %}
          <label>
            <input type="checkbox" class="filter-theme-checkbox" value="{{ theme }}" /> {{ theme }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Skills -->
      <div class="filter-group skills">
        <h3>Skills</h3>
        {% for skill in skills %}
          <label>
            <input type="checkbox" class="filter-skill-checkbox" value="{{ skill }}" /> {{ skill }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Relevant Device -->
      <div class="filter-group device">
        <h3>Relevant Devices</h3>
        {% for dev in devices %}
          <label>
            <input type="checkbox" class="filter-device-checkbox" value="{{ dev }}" /> {{ dev }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Awards -->
      <div class="filter-group awards">
        <h3>Awards</h3>
        {% for award in awards %}
          <label>
            <input type="checkbox" class="filter-award-checkbox" value="{{ award }}" /> {{ award }}
          </label><br />
        {% endfor %}
      </div>
    </div>

    <!-- Right Column: Publications Grid -->
    <div class="publications-grid">
      <div id="active-filters-panel"></div>

      {% for pub in sorted_pubs %}
        <!-- Get the full venue name -->
        {% include venue_name.html venue=pub.venue %}

        <div class="publication-card"
            data-year="{{ pub.date | date: '%Y' }}"
            data-health-topic="{{ pub.health_topic | join: ',' }}"
            data-venue="{{ venue_transformed }}"
            data-author="{{ pub.authors | join: ',' }}"
            data-theme="{{ pub.theme | join: ',' }}"
            data-skills="{{ pub.skills | join: ',' }}"
            data-device="{% if pub.device %}{{ pub.device | join: ',' }}{% elsif pub.devices %}{{ pub.devices | join: ',' }}{% endif %}"
            data-dataset="{{ pub.dataset_available }}"
            data-award="{{ pub.award }}">
          <div class="pub-image">
            {% if pub.date <= site.time %}
            <a href="{{ pub.link }}">
              <img src="{{ pub.thumbnail }}" alt="{{ pub.title }}">
            </a>
            {% else %}
            <img src="{{ pub.thumbnail }}" alt="{{ pub.title }}">
            {% endif %}
          </div>
          <div class="pub-info">
            {% if pub.date <= site.time %}
              <a href="{{ pub.link }}">
                <h2>{{ pub.title }}</h2>
              </a>
            {% else %}
              <h2>{{ pub.title }}</h2>
            {% endif %}
            <p class="authors">
              {% include author_list.html authors=pub.authors %}
            </p>
            <p class="venue-year">
              <em>
                {% if pub.date > site.time %}
                  <span class="to-appear">To appear in </span>
                {% endif %}
                {% if pub.subvenue %}
                  {{ pub.subvenue }},
                {% endif %}
                {{ venue_transformed }}, {{ pub.date | date: "%Y" }}
              </em>
              {% if pub.award %}
                <span class="award"> – {{ pub.award }}</span>
              {% endif %}
            </p>

            <!-- Abstract and Video Buttons -->
            <div class="pub-buttons">
              {% if pub.abstract %}
              <button type="button" class="btn btn-abstract" aria-label="Abstract" data-toggle="modal" data-target="#{{ pub.title | slugify }}_abstract">
                <i class="fas fa-book"></i> Abstract
              </button>
              {% endif %}

              {% if pub.video_embed %}
              <button type="button" class="btn btn-video" aria-label="Video" data-toggle="modal" data-target="#{{ pub.title | slugify }}_video">
                <i class="fas fa-play"></i> Video
              </button>
              {% endif %}

              {% if pub.data_embed %}
              <button type="button" class="btn btn-data" aria-label="Dataset" data-toggle="modal" data-target="#{{ pub.title | slugify }}_data">
                <i class="fas fa-database"></i> Dataset
              </button>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Abstract Modal -->
        {% if pub.abstract %}
        <div class="modal fade" tabindex="-1" role="dialog" id="{{ pub.title | slugify }}_abstract">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">{{ pub.title }}</h4>
              </div>
              <div class="modal-body">
                {{ pub.abstract }}
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
        {% endif %}

        <!-- Video Modal -->
        {% if pub.video_embed %}
        <div class="modal fade" tabindex="-1" role="dialog" id="{{ pub.title | slugify }}_video">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">{{ pub.title }}</h4>
              </div>
              <div class="modal-body">
                <iframe width="560" height="315" src="{{ pub.video_embed }}" frameborder="0" allowfullscreen></iframe>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Close video when window closes -->
        <script>
          $('#{{pub.title | slugify}}_video').on('hidden.bs.modal', function () {
            $("#{{pub.title | slugify}}_video iframe").attr("src", $("#{{pub.title | slugify}}_video iframe").attr("src"));
          });
        </script>
        {% endif %}

      {% endfor %}
    </div>
  </div>

  <!-- Viewport meta tag script -->
  <script>
    // Check if viewport meta tag exists
    if (!document.querySelector('meta[name="viewport"]')) {
      // Create and append viewport meta tag
      const viewportMeta = document.createElement('meta');
      viewportMeta.name = 'viewport';
      viewportMeta.content = 'width=device-width, initial-scale=1.0';
      document.head.appendChild(viewportMeta);
    }
  </script>
</div>
<!-- JavaScript for filtering functionality -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Desktop filters
    const searchInput = document.querySelector('.desktop-search');
    const yearSelect = document.getElementById('yearSelect');
    const healthTopicSelect = document.getElementById('healthTopicSelect');
    const venueSelect = document.getElementById('venueSelect');
    const authorSelect = document.getElementById('authorSelect');
    const themeCheckboxes = Array.from(document.querySelectorAll('.filter-theme-checkbox'));
    const skillCheckboxes = Array.from(document.querySelectorAll('.filter-skill-checkbox'));
    const deviceCheckboxes = Array.from(document.querySelectorAll('.filter-device-checkbox'));
    const awardCheckboxes = Array.from(document.querySelectorAll('.filter-award-checkbox'));

    // Mobile filters
    const mobileSearchInput = document.querySelector('.mobile-search');
    const mobileYearSelect = document.getElementById('mobile-yearSelect');
    const mobileHealthTopicSelect = document.getElementById('mobile-healthTopicSelect');
    const mobileVenueSelect = document.getElementById('mobile-venueSelect');
    const mobileAuthorSelect = document.getElementById('mobile-authorSelect');
    const mobileThemeCheckboxes = Array.from(document.querySelectorAll('.mobile-theme-checkbox'));
    const mobileSkillCheckboxes = Array.from(document.querySelectorAll('.mobile-skill-checkbox'));
    const mobileDeviceCheckboxes = Array.from(document.querySelectorAll('.mobile-device-checkbox'));
    const mobileAwardCheckboxes = Array.from(document.querySelectorAll('.mobile-award-checkbox'));

    // Common elements
    const publicationCards = Array.from(document.querySelectorAll('.publication-card'));
    const activeFiltersPanel = document.getElementById('active-filters-panel');

    // Mobile filter overlay controls
    const overlay = document.querySelector('.filter-overlay');
    const openBtn = document.querySelector('.mobile-filter-toggle');
    const closeBtn = document.querySelector('.close-filters');
    const applyBtn = document.querySelector('.apply-filters');

    // Toggle mobile filter overlay
    if (overlay && openBtn && closeBtn) {
      openBtn.addEventListener('click', () => overlay.classList.add('active'));
      closeBtn.addEventListener('click', () => overlay.classList.remove('active'));
    }

    // Sync filters between desktop and mobile
    function syncFilters(fromMobile = false) {
      if (fromMobile) {
        // Copy from mobile to desktop
        searchInput.value = mobileSearchInput.value;
        yearSelect.value = mobileYearSelect.value;
        healthTopicSelect.value = mobileHealthTopicSelect.value;
        venueSelect.value = mobileVenueSelect.value;
        authorSelect.value = mobileAuthorSelect.value;

        mobileThemeCheckboxes.forEach((checkbox, index) => {
          if (index < themeCheckboxes.length) {
            themeCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileSkillCheckboxes.forEach((checkbox, index) => {
          if (index < skillCheckboxes.length) {
            skillCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileDeviceCheckboxes.forEach((checkbox, index) => {
          if (index < deviceCheckboxes.length) {
            deviceCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileAwardCheckboxes.forEach((checkbox, index) => {
          if (index < awardCheckboxes.length) {
            awardCheckboxes[index].checked = checkbox.checked;
          }
        });
      } 
      else {
        // Copy from desktop to mobile
        mobileSearchInput.value = searchInput.value;
        mobileYearSelect.value = yearSelect.value;
        mobileHealthTopicSelect.value = healthTopicSelect.value;
        mobileVenueSelect.value = venueSelect.value;
        mobileAuthorSelect.value = authorSelect.value;

        themeCheckboxes.forEach((checkbox, index) => {
          if (index < mobileThemeCheckboxes.length) {
            mobileThemeCheckboxes[index].checked = checkbox.checked;
          }
        });

        skillCheckboxes.forEach((checkbox, index) => {
          if (index < mobileSkillCheckboxes.length) {
            mobileSkillCheckboxes[index].checked = checkbox.checked;
          }
        });

        deviceCheckboxes.forEach((checkbox, index) => {
          if (index < mobileDeviceCheckboxes.length) {
            mobileDeviceCheckboxes[index].checked = checkbox.checked;
          }
        });

        awardCheckboxes.forEach((checkbox, index) => {
          if (index < mobileAwardCheckboxes.length) {
            mobileAwardCheckboxes[index].checked = checkbox.checked;
          }
        });
      }
    }

    function getCheckedValues(checkboxes) {
      let values = [];
      checkboxes.forEach(cb => {
        if(cb.checked) {
          values.push(cb.value);
        }
      });
      return values;
    }

    function filterPublications() {
      const query = searchInput.value;
      const selectedYear = yearSelect.value;
      const selectedHealthTopic = healthTopicSelect.value;
      const selectedVenue = venueSelect.value;
      const selectedAuthor = authorSelect.value;
      const selectedThemes = getCheckedValues(themeCheckboxes);
      const selectedSkills = getCheckedValues(skillCheckboxes);
      const selectedDevices = getCheckedValues(deviceCheckboxes);
      const selectedAwards = getCheckedValues(awardCheckboxes);

      publicationCards.forEach(card => {
        // Search
        let text = card.textContent.toLowerCase();
        if (query && !text.includes(query)) {
          card.style.display = 'none';
          return;
        }
        // Dropdowns
        if (selectedYear && card.dataset.year !== selectedYear) {
          card.style.display = 'none';
          return;
        }
        if (selectedHealthTopic && !card.dataset.healthTopic.includes(selectedHealthTopic)) {
          card.style.display = 'none';
          return;
        }
        if (selectedVenue && !card.dataset.venue.includes(selectedVenue)) {
          card.style.display = 'none';
          return;
        }
        if (selectedAuthor && !card.dataset.author.includes(selectedAuthor)) {
          card.style.display = 'none';
          return;
        }
        // Checkboxes
        if (selectedThemes.length > 0) {
          const cardThemes = card.dataset.theme.split(',').map(t => t.trim());
          if (!selectedThemes.some(theme => cardThemes.includes(theme))) {
            card.style.display = 'none';
            return;
          }
        }
        if (selectedSkills.length > 0) {
          const cardSkills = card.dataset.skills.split(',').map(s => s.trim());
          if (!selectedSkills.some(skill => cardSkills.includes(skill))) {
            card.style.display = 'none';
            return;
          }
        }
        if (selectedDevices.length > 0) {
          const cardDevice = card.dataset.device;
          if (!selectedDevices.some(device => cardDevice.includes(device))) {
            card.style.display = 'none';
            return;
          }
        }
        if (selectedAwards.length > 0) {
          const cardAward = card.dataset.award;
          if (!selectedAwards.some(award => cardAward.includes(award))) {
            card.style.display = 'none';
            return;
          }
        }
        card.style.display = '';
      });
      updateActiveFilters();
    }

    function updateActiveFilters() {
      // Skip early if no filters are active
      activeFiltersPanel.innerHTML = '';
      const hasActiveFilters =
              searchInput.value ||
              yearSelect.value ||
              healthTopicSelect.value ||
              venueSelect.value ||
              authorSelect.value ||
              themeCheckboxes.some(c => c.checked) ||
              skillCheckboxes.some(c => c.checked) ||
              deviceCheckboxes.some(c => c.checked) ||
              awardCheckboxes.some(c => c.checked);

      if (!hasActiveFilters) {
        activeFiltersPanel.style.display = 'none';
        return;
      }
      activeFiltersPanel.style.display = 'block';

      // Search
      if (searchInput.value.trim() !== "") {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Search: ' + searchInput.value + ' <span class="remove-tag" data-type="search">×</span>';
        activeFiltersPanel.appendChild(tag);
      }
      // Dropdowns
      if (yearSelect.value) {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Year: ${yearSelect.selectedOptions[0].text} <span class="remove-tag" data-type="year" data-value="">×</span></span>`;
      }
      if (healthTopicSelect.value) {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Health Topic: ${healthTopicSelect.selectedOptions[0].text} <span class="remove-tag" data-type="health" data-value="">×</span></span>`;
      }
      if (venueSelect.value) {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Venue: ${venueSelect.selectedOptions[0].text} <span class="remove-tag" data-type="venue" data-value="">×</span></span>`;
      }
      if (authorSelect.value) {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Author: ${authorSelect.selectedOptions[0].text} <span class="remove-tag" data-type="author" data-value="">×</span></span>`;
      }
      // Checkboxes
      themeCheckboxes.filter(c=>c.checked).forEach(c => {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Theme: ${c.value} <span class="remove-tag" data-type="theme" data-value="${c.value}">×</span></span>`;
      });
      skillCheckboxes.filter(c=>c.checked).forEach(c => {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Skill: ${c.value} <span class="remove-tag" data-type="skill" data-value="${c.value}">×</span></span>`;
      });
      deviceCheckboxes.filter(c=>c.checked).forEach(c => {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Device: ${c.value} <span class="remove-tag" data-type="device" data-value="${c.value}">×</span></span>`;
      });
      awardCheckboxes.filter(c=>c.checked).forEach(c => {
        activeFiltersPanel.innerHTML += `<span class="active-filter-tag">Award: ${c.value} <span class="remove-tag" data-type="award" data-value="${c.value}">×</span></span>`;
      });

      // Add event listeners to removal tags
      activeFiltersPanel.querySelectorAll('.remove-tag').forEach(el => {
        el.addEventListener('click', function() {
          const type = this.dataset.type;
          const value = this.dataset.value;
          removeFilter(type, value);
        });
      });
    }

    function removeFilter(type, value) {
      // Search
      if (type === 'search') {
        searchInput.value = '';
        mobileSearchInput.value = '';
      } 
      // Dropdowns
      else if (type === 'year') {
        yearSelect.value = '';
        mobileYearSelect.value = '';
      } 
      else if (type === 'health') {
        healthTopicSelect.value = '';
        mobileHealthTopicSelect.value = '';
      } 
      else if (type === 'venue') {
        venueSelect.value = '';
        mobileVenueSelect.value = '';
      } 
      else if (type === 'author') {
        authorSelect.value = '';
        mobileAuthorSelect.value = '';
      } 
      // Checkboxes
      else if (type === 'theme') {
        themeCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
        mobileThemeCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
      } 
      else if (type === 'skill') {
        skillCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
        mobileSkillCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
      } 
      else if (type === 'device') {
        deviceCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
        mobileDeviceCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
      } 
      else if (type === 'award') {
        awardCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
        mobileAwardCheckboxes.forEach(cb => {
          if (cb.value === value) cb.checked = false;
        });
      }
      syncFilters();
      filterPublications();
    }

    // Search filter event listeners
    if (searchInput) searchInput.addEventListener('input', function() {
      syncFilters();
      filterPublications();
    });
    if (mobileSearchInput) mobileSearchInput.addEventListener('input', function() {
      searchInput.value = mobileSearchInput.value;
      filterPublications();
    });

    // Dropdown filter event listeners
    [yearSelect, healthTopicSelect, venueSelect, authorSelect].forEach(select => {
      select.addEventListener('change', () => {
        syncFilters();
        filterPublications();
      });
    });

    // Checkbox filter event listeners
    [...themeCheckboxes, ...skillCheckboxes, ...deviceCheckboxes, ...awardCheckboxes].forEach(c=>c.addEventListener('change', () => {
      syncFilters();
      filterPublications();
    }));

    // Apply button event listener
    applyBtn.addEventListener('click', () => {
      syncFilters(true);
      filterPublications();
      overlay.classList.remove('active');
    });

    // Initialize active filters panel
    updateActiveFilters();
  });
</script>