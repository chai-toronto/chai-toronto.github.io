---
layout: default
title: Publications
---

{% assign sorted_pubs = site.publications | sort: 'date' | reverse %}
{% include populate_filters.html %}

<div class="publications-page">
  <h1>Publications</h1>

  <!-- Mobile Controls (Filter Button + Search) -->
  <div class="mobile-controls">
    <button class="mobile-filter-toggle btn">Filters</button>
    <input type="text" class="pub-search mobile-search" placeholder="Search" />
  </div>

  <!-- Filter Overlay (for mobile) -->
  <div class="filter-overlay">
    <div class="filter-panel">
      <header>
        <button class="close-filters">Ã—</button>
      </header>

      <div class="filter-section">
        <!-- Year Published -->
        <h3>Year Published</h3>
        <select id="mobile-yearSelect">
          <option value="">All</option>
          {% for y in years %}
            <option value="{{ y }}">{{ y }}</option>
          {% endfor %}
        </select>

        <!-- Health Topic -->
        <h3>Health Topic</h3>
        <select id="mobile-healthTopicSelect">
          <option value="">All</option>
          {% for topic in healthTopics %}
            <option value="{{ topic }}">{{ topic }}</option>
          {% endfor %}
        </select>

        <!-- Conference -->
        <h3>Conference</h3>
        <select id="mobile-conferenceSelect">
          <option value="">All</option>
          {% for conf in conferences %}
            {% assign conf_parts = conf | split: "," %}
            {% assign conf_transformed = "" %}
            {% for cp in conf_parts %}
            {% assign cp = cp | strip %}
            {% if cp contains "$" %}
            {% assign venue_item = site.data.venues | where:"id", cp | first %}
            {% if venue_item %}
            {% assign cp_trans = venue_item.full_name %}
            {% else %}
            {% assign cp_trans = cp %}
            {% endif %}
            {% else %}
            {% assign cp_trans = cp %}
            {% endif %}
            {% if forloop.first %}
            {% assign conf_transformed = cp_trans %}
            {% else %}
            {% assign conf_transformed = conf_transformed | append: ", " | append: cp_trans %}
            {% endif %}
          {% endfor %}
          <option value="{{ conf | downcase }}">{{ conf_transformed }}</option>
          {% endfor %}
        </select>

        <!-- Contributors -->
        <h3>Graduate Student Contributors</h3>
        <select id="mobile-contributorsSelect">
          <option value="">Anyone</option>
          {% for author in all_author_ids %}
            {% assign found_member = site.data.members | where:"id", author | first %}
            {% if found_member %}
              {% if found_member.degree == 'PhD' or found_member.degree == "MSc" or found_member.degree == 'MScAC' %}
                <option value="{{ found_member.id }}">{{ found_member.name }}</option>
              {% endif %}
            {% endif %}
          {% endfor %}
        </select>

        <hr />

        <!-- Checkbox Filters -->
        <!-- Theme -->
        <div class="filter-group theme">
          <h3>Theme</h3>
          {% for theme in themes %}
            <label>
              <input type="checkbox" class="mobile-theme-checkbox" value="{{ theme | downcase }}" /> {{ theme }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Skills -->
        <div class="filter-group skills">
          <h3>Skills</h3>
          {% for skill in skills %}
            <label>
              <input type="checkbox" class="mobile-skill-checkbox" value="{{ skill | downcase }}" /> {{ skill }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Most Relevant Device -->
        <div class="filter-group device">
          <h3>Most Relevant Device</h3>
          {% for dev in devices %}
            <label>
              <input type="checkbox" class="mobile-device-checkbox" value="{{ dev | downcase }}" /> {{ dev }}
            </label><br />
          {% endfor %}
        </div>

        <hr />

        <!-- Awards -->
        <div class="filter-group awards">
          <h3>Awards</h3>
          {% for award in awards %}
            <label>
              <input type="checkbox" class="mobile-award-checkbox" value="{{ award | downcase }}" /> {{ award }}
            </label><br />
          {% endfor %}
        </div>

        <button class="apply-filters">Apply</button>
      </div>
    </div>
  </div>

  <div class="publication-content-row">
    <!-- Left Column: Filter Panel (desktop version) -->
    <div class="filter-section">
      <!-- Search bar -->
      <input type="text" class="pub-search desktop-search" placeholder="Search" />

      <!-- Year Published -->
      <h3 for="yearSelect">Year Published</h3>
      <select id="yearSelect">
        <option value="">All</option>
        {% for y in years %}
          <option value="{{ y }}">{{ y }}</option>
        {% endfor %}
      </select>

      <!-- Health Topic -->
      <h3 for="healthTopicSelect">Health Topic</h3>
      <select id="healthTopicSelect">
        <option value="">All</option>
        {% for topic in healthTopics %}
          <option value="{{ topic | downcase }}">{{ topic }}</option>
        {% endfor %}
      </select>

      <!-- Conference -->
      <h3 for="conferenceSelect">Conference</h3>
      <select id="conferenceSelect">
        <option value="">All</option>
        {% for conf in conferences %}
          {% assign conf_parts = conf | split: "," %}
          {% assign conf_transformed = "" %}
          {% for cp in conf_parts %}
          {% assign cp = cp | strip %}
          {% if cp contains "$" %}
          {% assign venue_item = site.data.venues | where:"id", cp | first %}
          {% if venue_item %}
          {% assign cp_trans = venue_item.full_name %}
          {% else %}
          {% assign cp_trans = cp %}
          {% endif %}
          {% else %}
          {% assign cp_trans = cp %}
          {% endif %}
          {% if forloop.first %}
          {% assign conf_transformed = cp_trans %}
          {% else %}
          {% assign conf_transformed = conf_transformed | append: ", " | append: cp_trans %}
          {% endif %}
          {% endfor %}
          <option value="{{ conf | downcase }}">{{ conf_transformed }}</option>
        {% endfor %}
      </select>

      <!-- Contributors -->
      <h3 for="contributorsSelect">Graduate Student Contributors</h3>
      <select id="contributorsSelect">
        <option value="">Anyone</option>
        {% for author in all_author_ids %}
          {% assign found_member = site.data.members | where:"id", author | first %}
          {% if found_member %}
            {% if found_member.degree == 'PhD' or found_member.degree == "MSc" or found_member.degree == 'MScAC' %}
              <option value="{{ found_member.id }}">{{ found_member.name }}</option>
            {% endif %}
          {% endif %}
        {% endfor %}
      </select>

      <hr />

      <!-- Checkbox Filters -->
      <!-- Theme (Publication Category) -->
      <div class="filter-group theme">
        <h3>Theme</h3>
        {% for theme in themes %}
          <label>
            <input type="checkbox" class="filter-theme-checkbox" value="{{ theme | downcase }}" /> {{ theme }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Skills -->
      <div class="filter-group skills">
        <h3>Skills</h3>
        {% for skill in skills %}
          <label>
            <input type="checkbox" class="filter-skill-checkbox" value="{{ skill | downcase }}" /> {{ skill }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Most Relevant Device -->
      <div class="filter-group device">
        <h3>Most Relevant Device</h3>
        {% for dev in devices %}
          <label>
            <input type="checkbox" class="filter-device-checkbox" value="{{ dev | downcase }}" /> {{ dev }}
          </label><br />
        {% endfor %}
      </div>

      <hr />

      <!-- Awards -->
      <div class="filter-group awards">
        <h3>Awards</h3>
        {% for award in awards %}
          <label>
            <input type="checkbox" class="filter-award-checkbox" value="{{ award | downcase }}" /> {{ award }}
          </label><br />
        {% endfor %}
      </div>
    </div>

    <!-- Right Column: Publications Grid -->
    <div class="publications-grid">
      <div id="active-filters-panel"></div>

      {% for pub in sorted_pubs %}
      <div class="publication-card"
           data-year="{{ pub.date | date: '%Y' }}"
           data-health-topic="{{ pub.health_topic | join: ',' | downcase }}"
           data-conference="{{ pub.venue | downcase }}"
           data-contributors="{{ pub.authors | join: ',' | downcase }}"
           data-theme="{{ pub.category | join: ',' | downcase }}"
           data-skills="{{ pub.skills | join: ',' | downcase }}"
           data-device="{% if pub.device %}{{ pub.device | join: ',' | downcase }}{% elsif pub.devices %}{{ pub.devices | join: ',' | downcase }}{% endif %}"
           data-dataset="{{ pub.dataset_available | downcase }}"
           data-award="{{ pub.award | downcase }}">
        <div class="pub-image">
          {% if pub.date <= site.time %}
          <a href="{{ pub.link }}">
            <img src="{{ pub.thumbnail }}" alt="{{ pub.title }}">
          </a>
          {% else %}
          <img src="{{ pub.thumbnail }}" alt="{{ pub.title }}">
          {% endif %}
        </div>
        <div class="pub-info">
          {% if pub.date <= site.time %}
          <a href="{{ pub.link }}">
            <h2>{{ pub.title }}</h2>
          </a>
          {% else %}
          <h2>{{ pub.title }}</h2>
          {% endif %}
          <p class="authors">
            {% include author_list.html authors=pub.authors %}
          </p>
          <p class="venue-year">
            <em>
              {% if pub.date > site.time %}
              <span class="to-appear">To appear in </span>
              {% endif %}
              {% if pub.subvenue %}
              {{ pub.subvenue }},
              {% endif %}
              {% assign venue_raw = pub.venue %}
              {% assign venue_transformed = "" %}
              {% if venue_raw contains "$" %}
              {% assign venue_parts = venue_raw | split: "," %}
              {% for part in venue_parts %}
              {% assign part = part | strip %}
              {% assign venue_item = site.data.venues | where:"id", part | first %}
              {% if venue_item %}
              {% assign venue_transformed = venue_transformed | append: venue_item.full_name %}
              {% else %}
              {% assign venue_transformed = venue_transformed | append: part %}
              {% endif %}
              {% if forloop.last == false %}
              {% assign venue_transformed = venue_transformed | append: ", " %}
              {% endif %}
              {% endfor %}
              {% else %}
              {% assign venue_transformed = venue_raw %}
              {% endif %}
              {{ venue_transformed }}, {{ pub.date | date: "%Y" }}
            </em>
            {% if pub.award %}
            <span class="award"> â€“ {{ pub.award }}</span>
            {% endif %}
          </p>

          <!-- Abstract and Video Buttons -->
          <div class="pub-buttons">
            {% if pub.abstract %}
            <button type="button" class="btn btn-abstract" aria-label="Abstract" data-toggle="modal" data-target="#{{ pub.title | slugify }}_abstract">
              <i class="fas fa-book"></i> Abstract
            </button>
            {% endif %}

            {% if pub.video_embed %}
            <button type="button" class="btn btn-video" aria-label="Video" data-toggle="modal" data-target="#{{ pub.title | slugify }}_video">
              <i class="fas fa-play"></i> Video
            </button>
            {% endif %}

            {% if pub.data_embed %}
            <button type="button" class="btn btn-data" aria-label="Dataset" data-toggle="modal" data-target="#{{ pub.title | slugify }}_data">
              <i class="fas fa-database"></i> Dataset
            </button>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Abstract Modal -->
      {% if pub.abstract %}
      <div class="modal fade" tabindex="-1" role="dialog" id="{{ pub.title | slugify }}_abstract">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">{{ pub.title }}</h4>
            </div>
            <div class="modal-body">
              {{ pub.abstract }}
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Video Modal -->
      {% if pub.video_embed %}
      <div class="modal fade" tabindex="-1" role="dialog" id="{{ pub.title | slugify }}_video">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">{{ pub.title }}</h4>
            </div>
            <div class="modal-body">
              <iframe width="560" height="315" src="{{ pub.video_embed }}" frameborder="0" allowfullscreen></iframe>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Close video when window closes -->
      <script>
        $('#{{pub.title | slugify}}_video').on('hidden.bs.modal', function () {
          $("#{{pub.title | slugify}}_video iframe").attr("src", $("#{{pub.title | slugify}}_video iframe").attr("src"));
        });
      </script>
      {% endif %}

      {% endfor %}
    </div>
  </div>

  <!-- Viewport meta tag script -->
  <script>
    // Check if viewport meta tag exists
    if (!document.querySelector('meta[name="viewport"]')) {
      // Create and append viewport meta tag
      const viewportMeta = document.createElement('meta');
      viewportMeta.name = 'viewport';
      viewportMeta.content = 'width=device-width, initial-scale=1.0';
      document.head.appendChild(viewportMeta);
    }
  </script>
</div>
<!-- JavaScript for filtering functionality -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Desktop filters
    const searchInput = document.querySelector('.desktop-search');
    const yearSelect = document.getElementById('yearSelect');
    const healthTopicSelect = document.getElementById('healthTopicSelect');
    const conferenceSelect = document.getElementById('conferenceSelect');
    const contributorsSelect = document.getElementById('contributorsSelect');
    const themeCheckboxes = document.querySelectorAll('.filter-theme-checkbox');
    const skillCheckboxes = document.querySelectorAll('.filter-skill-checkbox');
    const deviceCheckboxes = document.querySelectorAll('.filter-device-checkbox');
    const awardCheckboxes = document.querySelectorAll('.filter-award-checkbox');

    // Mobile filters
    const mobileSearchInput = document.querySelector('.mobile-search');
    const mobileYearSelect = document.getElementById('mobile-yearSelect');
    const mobileHealthTopicSelect = document.getElementById('mobile-healthTopicSelect');
    const mobileConferenceSelect = document.getElementById('mobile-conferenceSelect');
    const mobileContributorsSelect = document.getElementById('mobile-contributorsSelect');
    const mobileThemeCheckboxes = document.querySelectorAll('.mobile-theme-checkbox');
    const mobileSkillCheckboxes = document.querySelectorAll('.mobile-skill-checkbox');
    const mobileDeviceCheckboxes = document.querySelectorAll('.mobile-device-checkbox');
    const mobileAwardCheckboxes = document.querySelectorAll('.mobile-award-checkbox');

    // Common elements
    const publicationCards = document.querySelectorAll('.publication-card');
    const activeFiltersPanel = document.getElementById('active-filters-panel');

    // Mobile filter overlay controls
    const overlay = document.querySelector('.filter-overlay');
    const openBtn = document.querySelector('.mobile-filter-toggle');
    const closeBtn = document.querySelector('.close-filters');
    const applyBtn = document.querySelector('.apply-filters');

    // Toggle mobile filter overlay
    if (openBtn && closeBtn && overlay) {
      openBtn.addEventListener('click', () => overlay.classList.add('active'));
      closeBtn.addEventListener('click', () => overlay.classList.remove('active'));
    }

    // Sync filters between desktop and mobile
    function syncFilters(fromMobile = false) {
      if (fromMobile) {
        // Copy from mobile to desktop
        searchInput.value = mobileSearchInput.value;
        yearSelect.value = mobileYearSelect.value;
        healthTopicSelect.value = mobileHealthTopicSelect.value;
        conferenceSelect.value = mobileConferenceSelect.value;
        contributorsSelect.value = mobileContributorsSelect.value;

        mobileThemeCheckboxes.forEach((checkbox, index) => {
          if (index < themeCheckboxes.length) {
            themeCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileSkillCheckboxes.forEach((checkbox, index) => {
          if (index < skillCheckboxes.length) {
            skillCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileDeviceCheckboxes.forEach((checkbox, index) => {
          if (index < deviceCheckboxes.length) {
            deviceCheckboxes[index].checked = checkbox.checked;
          }
        });

        mobileAwardCheckboxes.forEach((checkbox, index) => {
          if (index < awardCheckboxes.length) {
            awardCheckboxes[index].checked = checkbox.checked;
          }
        });
      } else {
        // Copy from desktop to mobile
        mobileSearchInput.value = searchInput.value;
        mobileYearSelect.value = yearSelect.value;
        mobileHealthTopicSelect.value = healthTopicSelect.value;
        mobileConferenceSelect.value = conferenceSelect.value;
        mobileContributorsSelect.value = contributorsSelect.value;

        themeCheckboxes.forEach((checkbox, index) => {
          if (index < mobileThemeCheckboxes.length) {
            mobileThemeCheckboxes[index].checked = checkbox.checked;
          }
        });

        skillCheckboxes.forEach((checkbox, index) => {
          if (index < mobileSkillCheckboxes.length) {
            mobileSkillCheckboxes[index].checked = checkbox.checked;
          }
        });

        deviceCheckboxes.forEach((checkbox, index) => {
          if (index < mobileDeviceCheckboxes.length) {
            mobileDeviceCheckboxes[index].checked = checkbox.checked;
          }
        });

        awardCheckboxes.forEach((checkbox, index) => {
          if (index < mobileAwardCheckboxes.length) {
            mobileAwardCheckboxes[index].checked = checkbox.checked;
          }
        });
      }
    }

    function getCheckedValues(checkboxes) {
      let values = [];
      checkboxes.forEach(cb => {
        if(cb.checked) {
          values.push(cb.value.toLowerCase());
        }
      });
      return values;
    }

    function filterPublications() {
      const query = searchInput.value.toLowerCase();
      const selectedYear = yearSelect.value;
      const selectedHealthTopic = healthTopicSelect.value.toLowerCase();
      const selectedConference = conferenceSelect.value.toLowerCase();
      const selectedContributors = contributorsSelect.value.toLowerCase();
      const selectedThemes = getCheckedValues(themeCheckboxes);
      const selectedSkills = getCheckedValues(skillCheckboxes);
      const selectedDevices = getCheckedValues(deviceCheckboxes);
      const selectedAwards = getCheckedValues(awardCheckboxes);

      publicationCards.forEach(card => {
        let text = card.textContent.toLowerCase();
        if(query && !text.includes(query)) {
          card.style.display = 'none';
          return;
        }
        if(selectedYear && card.dataset.year !== selectedYear) {
          card.style.display = 'none';
          return;
        }
        if(selectedHealthTopic && !card.dataset.healthTopic.includes(selectedHealthTopic)) {
          card.style.display = 'none';
          return;
        }
        if(selectedConference && !card.dataset.conference.includes(selectedConference)) {
          card.style.display = 'none';
          return;
        }
        if(selectedContributors && !card.dataset.contributors.includes(selectedContributors)) {
          card.style.display = 'none';
          return;
        }
        if(selectedThemes.length > 0) {
          const cardThemes = card.dataset.theme.split(',').map(t => t.trim());
          if (!selectedThemes.some(theme => cardThemes.includes(theme))) {
            card.style.display = 'none';
            return;
          }
        }
        if(selectedSkills.length > 0) {
          const cardSkills = card.dataset.skills.split(',').map(s => s.trim());
          if (!selectedSkills.some(skill => cardSkills.includes(skill))) {
            card.style.display = 'none';
            return;
          }
        }
        if(selectedDevices.length > 0) {
          const cardDevice = card.dataset.device;
          if (!selectedDevices.some(device => cardDevice.includes(device))) {
            card.style.display = 'none';
            return;
          }
        }
        if(selectedAwards.length > 0) {
          const cardAward = card.dataset.award;
          if (!selectedAwards.some(award => cardAward.includes(award))) {
            card.style.display = 'none';
            return;
          }
        }
        card.style.display = '';
      });
      updateActiveFilters();
    }

    function updateActiveFilters() {
      activeFiltersPanel.innerHTML = '';
      let hasActive = false;

      if (searchInput.value.trim() !== "") {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Search: ' + searchInput.value + ' <span class="remove-tag" data-type="search">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      }
      if (yearSelect.value) {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        const text = yearSelect.options[yearSelect.selectedIndex].text;
        tag.innerHTML = 'Year: ' + text + ' <span class="remove-tag" data-type="year">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      }
      if (healthTopicSelect.value) {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        const text = healthTopicSelect.options[healthTopicSelect.selectedIndex].text;
        tag.innerHTML = 'Health Topic: ' + text + ' <span class="remove-tag" data-type="health">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      }
      if (conferenceSelect.value) {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        const text = conferenceSelect.options[conferenceSelect.selectedIndex].text;
        tag.innerHTML = 'Conference: ' + text + ' <span class="remove-tag" data-type="conference">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      }
      if (contributorsSelect.value) {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        const text = contributorsSelect.options[contributorsSelect.selectedIndex].text;
        tag.innerHTML = 'Contributors: ' + text + ' <span class="remove-tag" data-type="contributors">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      }
      Array.from(themeCheckboxes).filter(cb => cb.checked).forEach(cb => {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Theme: ' + cb.value + ' <span class="remove-tag" data-type="theme" data-value="' + cb.value + '">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      });
      Array.from(skillCheckboxes).filter(cb => cb.checked).forEach(cb => {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Skill: ' + cb.value + ' <span class="remove-tag" data-type="skill" data-value="' + cb.value + '">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      });
      Array.from(deviceCheckboxes).filter(cb => cb.checked).forEach(cb => {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Device: ' + cb.value + ' <span class="remove-tag" data-type="device" data-value="' + cb.value + '">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      });
      Array.from(awardCheckboxes).filter(cb => cb.checked).forEach(cb => {
        hasActive = true;
        const tag = document.createElement('span');
        tag.className = 'active-filter-tag';
        tag.innerHTML = 'Award: ' + cb.value + ' <span class="remove-tag" data-type="award" data-value="' + cb.value + '">Ã—</span>';
        activeFiltersPanel.appendChild(tag);
      });

      activeFiltersPanel.style.display = hasActive ? 'block' : 'none';

      // Add event listeners to removal tags
      activeFiltersPanel.querySelectorAll('.remove-tag').forEach(el => {
        el.addEventListener('click', function() {
          const type = this.dataset.type;
          const value = this.dataset.value;
          removeFilter(type, value);
        });
      });
    }

    function removeFilter(type, value) {
      if(type === 'search') {
        searchInput.value = '';
        mobileSearchInput.value = '';
      } else if (type === 'year') {
        yearSelect.value = '';
        mobileYearSelect.value = '';
      } else if (type === 'health') {
        healthTopicSelect.value = '';
        mobileHealthTopicSelect.value = '';
      } else if (type === 'conference') {
        conferenceSelect.value = '';
        mobileConferenceSelect.value = '';
      } else if (type === 'contributors') {
        contributorsSelect.value = '';
        mobileContributorsSelect.value = '';
      } else if (type === 'theme') {
        themeCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
        mobileThemeCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
      } else if (type === 'skill') {
        skillCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
        mobileSkillCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
      } else if (type === 'device') {
        deviceCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
        mobileDeviceCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
      } else if (type === 'award') {
        awardCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
        mobileAwardCheckboxes.forEach(cb => {
          if(cb.value === value) cb.checked = false;
        });
      }
      filterPublications();
    }

    // Desktop filter event listeners
    if (searchInput) searchInput.addEventListener('input', function() {
      syncFilters();
      filterPublications();
    });

    // Mobile search event listener
    if (mobileSearchInput) mobileSearchInput.addEventListener('input', function() {
      searchInput.value = mobileSearchInput.value;
      filterPublications();
    });

    if (yearSelect) yearSelect.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    });

    if (healthTopicSelect) healthTopicSelect.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    });

    if (conferenceSelect) conferenceSelect.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    });

    if (contributorsSelect) contributorsSelect.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    });

    themeCheckboxes.forEach(cb => cb.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    }));

    skillCheckboxes.forEach(cb => cb.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    }));

    deviceCheckboxes.forEach(cb => cb.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    }));

    awardCheckboxes.forEach(cb => cb.addEventListener('change', function() {
      syncFilters();
      filterPublications();
    }));

    // Apply mobile filters
    if (applyBtn) {
      applyBtn.addEventListener('click', function() {
        syncFilters(true);
        filterPublications();
        overlay.classList.remove('active');
      });
    }

    // Initial filtering
    updateActiveFilters();
  });
</script>